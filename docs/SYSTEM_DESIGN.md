# 4. 系统架构与功能模块设计

本章在原有写法基础上，结合当前项目的实际实现（Vue2 + Spring Boot），对系统架构与功能模块进行重新梳理与补充说明。

## 4.1. 系统架构设计

系统整体架构采用五层结构（如图4-1所示），分别为：表示层、应用层、接口层、服务层和数据存储层。各层职责如下。

### 4.1.1. 表示层

表示层主要为平台用户通过浏览器访问系统，完成页面浏览、表单输入、按钮点击等操作，并接收系统返回的业务处理结果。该层聚焦于“用户与系统”的交互入口。

### 4.1.2. 应用层

应用层负责界面展示与交互逻辑实现，用户通过页面组件完成检索、跳转、提交等操作。应用层将用户操作封装为 HTTP 请求并发送至后端接口层，同时在接收到响应后完成页面渲染与状态更新。

本系统应用层主要技术栈为：Vue 2、Element-UI、axios、JavaScript。

### 4.1.3. 接口层

接口层负责对外提供统一的 RESTful API（统一以 `/api/**` 为前缀），实现前后端的数据交互与协议约束。该层主要完成：

- 请求路由与参数接收（Controller）
- 登录态校验与访问拦截（如登录拦截器、Shiro 会话/RememberMe）
- 跨域配置与统一的 JSON 数据返回
- 文件上传与静态资源访问（如封面/头像等通过 `/api/file/**` 访问）

通过接口层，前端能够向后端发送业务请求并接收处理结果，从而完成“前端展示—后端处理—结果返回”的闭环。

### 4.1.4. 服务层

服务层主要负责实现系统核心业务逻辑，起到承上启下的作用：向上承接接口层的业务请求，向下调用数据访问层与缓存组件，完成数据处理并返回结果。该层主要包括：

- 业务逻辑实现（如电影、影评、收藏、短评等）
- 权限与角色校验（管理员/普通用户）
- 数据校验、频控与内容安全处理（如短评长度限制、敏感词、频率限制等）
- 缓存优化（Spring Cache + Redis，对列表/详情等热点数据进行缓存）

本系统服务层主要技术栈为：Spring Boot、Spring MVC、Spring Data JPA、Apache Shiro、Spring Cache、Redis 等。

### 4.1.5. 数据存储层

数据存储层负责对系统业务数据进行持久化存储与读取，主要包括：

- MySQL：存储用户信息、电影信息、分类信息、影评文章、用户收藏、观影状态、短评/点赞等核心数据
- Redis：作为缓存组件，缓存电影/影评等高频读取数据，降低数据库压力、提升响应速度
- 本地文件存储：用于保存上传的封面/头像等文件，并通过后端映射路径对外提供访问

**图4-1 系统整体架构图（示意）**

```text
用户/浏览器（表示层）
        |
Vue2 + Element-UI（应用层）
        |
REST API (/api/**)（接口层）
        |
Service（业务逻辑/权限/缓存）（服务层）
        |
MySQL + Redis + 文件存储（数据存储层）
```

## 4.2. 系统功能结构设计

系统功能结构在原“用户管理、电影管理、影评管理、收藏管理”四大模块的基础上，结合当前版本新增的用户行为与短评互动能力，形成如下五个功能模块（如图4-2所示）：

1) 用户管理模块  
2) 电影管理模块  
3) 影评（文章）管理模块  
4) 收藏与观影状态管理模块  
5) 短评与评分互动模块（新增）  

**图4-2 功能结构图（示意）**：可按上述五个模块绘制树状功能结构图。

### 4.2.1. 用户管理模块

用户管理模块主要负责用户身份认证、权限验证以及个人信息管理，主要包含：

(1) 个人信息管理：用户可查看并修改个人资料（如昵称、邮箱、电话、头像等），系统对更新信息进行校验后写入数据库。  
(2) 用户登录：用户输入用户名与密码，系统通过 Shiro 完成认证，认证成功后建立会话/RememberMe 登录态；失败则返回错误信息。  
(3) 用户注册：用户填写账号信息提交注册，系统校验用户名唯一性并将密码加盐哈希后入库，返回注册结果。  
(4) 用户权限管理：系统区分管理员与普通用户；当用户访问管理员功能时，系统需要进行角色/权限校验，不通过则返回无权限提示。  

### 4.2.2. 电影管理模块

电影管理模块负责电影条目维护、分类浏览、详情展示等，主要包含：

(1) 电影信息管理：管理员可对电影信息进行新增、修改、删除；系统对数据合法性进行校验并持久化到数据库。  
(2) 查看电影详情信息：用户可从电影列表/搜索结果进入详情页，查看电影封面、简介、主演/导演、上映日期等信息。  
(3) 电影分类管理：用户可按分类浏览电影列表，系统按分类筛选并返回对应电影数据。  
(4) 封面上传与管理：管理员在维护电影信息时可上传电影封面，后端保存文件并返回可访问的资源路径供前端展示。  

### 4.2.3. 影评（文章）管理模块

影评管理模块主要围绕“博客文章/影评文章”进行管理与展示，主要包含：

(1) 影评信息管理：管理员可新增、编辑、删除影评文章；系统对文章标题、内容等进行校验并存储到数据库。  
(2) 查看影评详细信息：用户可浏览影评列表并进入详情页查看完整文章内容（支持富文本/Markdown 展示）。  

### 4.2.4. 收藏与观影状态管理模块

收藏与观影状态管理模块用于记录用户对电影的个人行为数据，主要包含：

(1) 收藏电影（我的收藏）：用户可对电影进行收藏/取消收藏，系统按用户维度记录收藏关系，并支持查看个人收藏列表。  
(2) 观影状态（想看/看过）：用户可将电影标记为“想看”或“看过”，系统记录状态与标记时间，并支持按状态查看列表。  
(3) 收藏室（影单）管理：系统提供收藏室（影单）条目浏览与维护能力，可按分类查看收藏室条目，并支持新增/删除收藏室条目。  

### 4.2.5. 短评与评分互动模块（新增）

为增强电影详情页的互动性与用户参与度，系统新增“短评与评分互动模块”，主要包含：

(1) 发布/修改短评与评分：用户可对某部电影提交评分（1~5 分）与短评内容（可只评分或只短评），系统对内容进行长度校验、频率限制与基础安全处理后保存。  
(2) 浏览短评列表：在电影详情页展示“大家的短评”，支持分页加载已发布的短评信息。  
(3) 短评点赞：用户可对短评进行点赞/取消点赞，系统对点赞关系做幂等处理，并展示点赞数量与当前用户点赞状态。  
(4) 评分统计：系统提供电影评分汇总信息（平均分/评分人数），用于在详情页展示整体评分情况。  
(5) 短评审核（管理员）：管理员可对短评设置审核状态（通过/驳回/待审），用于内容治理与违规处理（按项目需要启用）。  

